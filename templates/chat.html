<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <!-- ููู ููููุจุงูู -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>ูุญุงุฏุซุงุช ุนุงุฆููุฉ</title>
  <link rel="icon" href="{{ url_for('static', filename='logo.svg') }}" type="image/svg+xml">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <meta name="theme-color" content="#667eea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- ุฃุถู ูู head -->
  <meta name="description" content="ุชุทุจูู ูุญุงุฏุซุงุช ุนุงุฆูู ุขูู ูุณูู ุงูุงุณุชุฎุฏุงู - Family Chat">
  <meta name="keywords" content="ูุญุงุฏุซุงุช, ุนุงุฆูุฉ, ุงุชุตุงู, ุฑุณุงุฆู, ุขูู">
  <meta property="og:title" content="ูุญุงุฏุซุงุช ุนุงุฆููุฉ">
  <meta property="og:description" content="ุชูุงุตู ูุน ุนุงุฆูุชู ุจุณูููุฉ">
  <meta property="og:image" content="/static/logo.svg">
  <meta property="og: url" content="https://yourdomain.com">
  <link rel="preload" as="audio" href="{{ url_for('static', filename='sounds/notify.wav') }}">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}?v=15">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body data-user-id="{{ current_user.id }}" data-user-name="{{ current_user.name }}" data-user-phone="{{ current_user.phone_number }}" data-group-ids='{{ group_ids | tojson }}'>
  <div class="background-layer">
  </div>

  <div class="overlay" id="overlay"></div>

  <div class="chat-container">
    <div class="users-list" id="usersDrawer">
      <!-- ุงููุณุชุฎุฏู ุงูุญุงูู -->
      <div class="current-user-profile" style="padding: 16px; border-bottom: 1px solid rgba(0,0,0,0.1); display: flex; align-items: center; gap: 12px; background: rgba(255,255,255,0.55);">
        <div style="position: relative; cursor: pointer;" onclick="document.getElementById('profile-upload').click()" title="ุงููุฑ ูุชุบููุฑ ุงูุตูุฑุฉ">
          <img
            src="{{ url_for('static', filename='profile_pics/' + (current_user.profile_pic or 'default.png')) }}"
            alt="Profile"
            style="width: 56px; height: 56px; border-radius: 50%; object-fit: cover; border: 2px solid #667eea; transition: all 0.2s ease;"
            id="current-user-img"
          >
          <div style="position: absolute; bottom: 0; right: 0; background: #667eea; color: white; border-radius: 50%; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; font-size: 13px; border: 2px solid white;">
            ๐ท
          </div>
        </div>

        <div style="overflow: hidden; min-width: 0;">
          <div style="font-weight: bold; font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ current_user.name }}</div>
          <div style="font-size: 12px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ current_user.phone_number }}</div>
        </div>

        <input type="file" id="profile-upload" style="display: none;" accept="image/*">
      </div>

      <div class="users-list-header">
        <h3>ุงููุญุงุฏุซุงุช</h3>
      </div>

      <ul id="users-list">
  <li class="user-item add-group" id="btnAddGroup">
    <div class="avatar-circle group"><i class="bi bi-people-fill"></i></div>
    <div class="user-info">
      <div class="user-name">ุฅุถุงูุฉ ูุฌููุนุฉ ุฌุฏูุฏุฉ</div>
          <div class="conv-flags"><span class="flag-pin" style="display:none;">๐</span><span class="flag-mute" style="display:none;">๐</span><span class="flag-arch" style="display:none;">๐๏ธ</span></div>
      <div class="user-status">ุฅูุดุงุก ูุฌููุนุฉ ูุฏุนูุฉ ุฃุนุถุงุก</div>
    </div>
  </li>

  
  <li class="user-item invites {% if not pending_group_invites or (pending_group_invites|length)==0 %}hidden{% endif %}" id="btnGroupInvites">
    <div class="avatar-circle"><i class="bi bi-inbox-fill"></i></div>
    <div class="user-info">
      <div class="user-name">ุทูุจุงุช ุงููุฌููุนุงุช</div>
          <div class="conv-flags"><span class="flag-pin" style="display:none;">๐</span><span class="flag-mute" style="display:none;">๐</span><span class="flag-arch" style="display:none;">๐๏ธ</span></div>
      <div class="user-status" id="invitesText">{% if pending_group_invites and (pending_group_invites|length)>0 %}ูุฏูู {{ pending_group_invites|length }} ุทูุจ{% else %}ูุง ุชูุฌุฏ ุทูุจุงุช{% endif %}</div>
    </div>
    <span class="badge" id="invitesBadge">{% if pending_group_invites and (pending_group_invites|length)>0 %}{{ pending_group_invites|length }}{% else %}0{% endif %}</span>
  </li>


  {# ูุงุฆูุฉ ููุญูุฏุฉ ูููุณุชุฎุฏููู + ุงููุฌููุนุงุช ูุฑุชุจุฉ ุญุณุจ ุขุฎุฑ ุฑุณุงูุฉ #}
  {% for c in conversations %}
    {% if c.type == 'group' %}
      {% set g = c.group %}
      <li data-group-id="{{ g.id }}" data-name="{{ g.name }}" data-owner-id="{{ g.owner_id }}" data-is-owner="{% if g.owner_id == current_user.id %}1{% else %}0{% endif %}"
        data-last-ms="{% if c.ts %}{{ (c.ts.timestamp() * 1000) | int }}{% else %}0{% endif %}"
        data-pinned-rank="{% if c.settings and c.settings.pinned_rank is not none %}{{ c.settings.pinned_rank }}{% endif %}"
        data-archived="{% if c.settings and c.settings.is_archived %}1{% else %}0{% endif %}"
        data-muted-until="{% if c.settings and c.settings.muted_until %}{{ c.settings.muted_until.isoformat() }}{% endif %}"
        class="user-item {% if active_group and active_group.id == g.id %}active{% endif %}">
        <div class="avatar-circle group"><i class="bi bi-people"></i></div>
        <div class="user-info">
          <div class="user-name">{{ g.name }}</div>
          <div class="user-status">ูุฌููุนุฉ</div>
        </div>
        <span class="badge-unread" style="display:none;"></span>
      </li>
    {% else %}
      {% set user = c.user %}
      <li data-user-id="{{ user.id }}"
          data-name="{{ user.name }}"
          data-last-ms="{% if c.ts %}{{ (c.ts.timestamp() * 1000) | int }}{% else %}0{% endif %}"
          data-avatar="{{ url_for('static', filename='profile_pics/' ~ (user.profile_pic or 'default.png')) }}"
          class="user-item {% if active_user and active_user.id == user.id %}active{% endif %}">
        <img src="{{ url_for('static', filename='profile_pics/' ~ (user.profile_pic or 'default.png')) }}" alt="{{ user.name }}">
        <div class="user-info">
          <div class="user-name">{{ user.name }}</div>
          <div class="user-status">{{ user.phone_number }}</div>
        </div>
        <span class="badge-unread" style="display:none;"></span>
      </li>
    {% endif %}
  {% endfor %}
</ul>

      <div class="logout-button-container">
        <button class="logout-button" id="logout-btn">๐ช ุชุณุฌูู ุงูุฎุฑูุฌ</button>
      </div>
    </div>

    <div class="chat-box">
      <div class="chat-header">
        <button 
          class="menu-btn" 
          id="openUsers"
          aria-label="ูุชุญ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช"
          aria-expanded="false"
          aria-controls="usersDrawer">
          <span aria-hidden="true">โฐ</span>
          <span>ุงููุญุงุฏุซุงุช</span>
        </button>
        <div class="chat-title-wrap">
          <img id="chat-avatar" class="chat-avatar" src="{% if active_user %}{{ url_for('static', filename='profile_pics/' ~ (active_user.profile_pic or 'default.png')) }}{% else %}{{ url_for('static', filename='profile_pics/default.png') }}{% endif %}" alt="avatar">
          <div class="chat-title-block">
            <h4 id="chat-title">{% if active_user %}{{ active_user.name }}{% else %}ุงุฎุชุฑ ูุญุงุฏุซุฉ{% endif %}</h4>
            <div id="chat-subtitle" class="chat-subtitle"></div>
          </div>
        </div>
        <span style="opacity:0.9;font-size:12px;" id="netStatus"></span>

        <div class="chat-header-actions" id="chatHeaderActions">
          <button type="button" class="hdr-btn" id="btnSearch" title="ุจุญุซ"><i class="bi bi-search"></i></button>
          <button type="button" class="hdr-btn" id="btnStarred" title="ุงูุฑุณุงุฆู ุงููููุฒุฉ"><i class="bi bi-star"></i></button>
          <button type="button" class="hdr-btn" id="btnGroupInfo" title="ูุนูููุงุช ุงููุฌููุนุฉ" style="display:none;"><i class="bi bi-info-circle"></i></button>
        </div>

        <div class="dropdown" id="groupActionsWrap" style="display:none;">
          <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="groupActionsBtn" data-bs-toggle="dropdown" aria-expanded="false">
            โ๏ธ
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="groupActionsBtn">
            <li><button class="dropdown-item" type="button" id="btnEditGroup">ุชุนุฏูู ุงุณู ุงููุฌููุนุฉ</button></li>
            <li><button class="dropdown-item text-danger" type="button" id="btnDeleteGroup">ุญุฐู ุงููุฌููุนุฉ</button></li>
            <li><hr class="dropdown-divider"></li>
            <li><button class="dropdown-item" type="button" id="btnLeaveGroup">ุงูุฎุฑูุฌ ูู ุงููุฌููุนุฉ</button></li>
            <li><button class="dropdown-item" type="button" id="btnBlockGroup">ุญุธุฑ ุงููุฌููุนุฉ</button></li>

            <li><hr class="dropdown-divider"></li>
            <li class="dropdown-header">ุงูุฅุดุนุงุฑุงุช</li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifMuteToggle">ูุชู ุงูุตูุช</label>
              <input class="notif-toggle" type="checkbox" id="notifMuteToggle">
            </li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifVolumeRange">ูุณุชูู ุงูุตูุช</label>
              <input class="notif-range" type="range" id="notifVolumeRange" min="0" max="100" step="1" value="40">
              <span class="notif-value" id="notifVolumeValue">40%</span>
            </li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifSoundMessage">ุตูุช ุงูุฑุณุงุฆู</label>
              <select class="notif-select" id="notifSoundMessage">
                <option value="notify">Notify (ุงูุชุฑุงุถู)</option>
                <option value="soft">Soft</option>
                <option value="ping">Ping</option>
              </select>
            </li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifSoundMention">ุตูุช ุงูุชูุจูู</label>
              <select class="notif-select" id="notifSoundMention">
                <option value="notify">Notify (ุงูุชุฑุงุถู)</option>
                <option value="soft">Soft</option>
                <option value="ping">Ping</option>
              </select>
            </li>

            
            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifSoundGroup">ุตูุช ุงููุฌููุนุงุช</label>
              <select class="notif-select" id="notifSoundGroup">
                <option value="notify">Notify (ุงูุชุฑุงุถู)</option>
                <option value="soft">Soft</option>
                <option value="ping">Ping</option>
              </select>
            </li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="notifSoundSystem">ุตูุช ุงููุธุงู</label>
              <select class="notif-select" id="notifSoundSystem">
                <option value="soft">Soft (ูุงุฏุฆ)</option>
                <option value="notify">Notify</option>
                <option value="ping">Ping</option>
              </select>
            </li>

            <li><hr class="dropdown-divider"></li>
            <li class="dropdown-header">ุฅุดุนุงุฑุงุช ุจุงูุฎูููุฉ</li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <label class="notif-label" for="pushEnableToggle">ุชูุนูู ุฅุดุนุงุฑุงุช ุนูุฏ ุฅุบูุงู ุงูุตูุญุฉ</label>
              <input class="notif-toggle" type="checkbox" id="pushEnableToggle">
            </li>

            <li class="dropdown-item notif-row" style="cursor:default;">
              <button class="dropdown-item notif-test-btn" type="button" id="pushTestBtn">๐ฐ๏ธ ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู (Push)</button>
            </li>

<li class="dropdown-item notif-row" style="cursor:default;">
              <button class="dropdown-item notif-test-btn" type="button" id="notifTestBtn">๐ ุงุฎุชุจุงุฑ ุงูุตูุช</button>
            </li>

          </ul>
        </div>

      </div>

      <div class="messages" id="messages">
        <div class="empty-state" id="empty-state">
          <div style="font-size: 64px; margin-bottom: 16px;">๐ฌ</div>
          <h5 style="margin:0 0 8px 0;">ูุง ุชูุฌุฏ ุฑุณุงุฆู ุจุนุฏ</h5>
          <p style="margin:0;">ุงุจุฏุฃ ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ!</p>
        </div>
      </div>

      <form class="message-input" id="message-form">
  <div class="reply-bar hidden" id="replyBar">
    <div class="reply-bar-inner">
      <div class="reply-meta">
        <div class="reply-title" id="replyTitle">ุฑุฏ</div>
        <div class="reply-snippet" id="replySnippet"></div>
      </div>
      <button type="button" class="reply-close" id="replyClose" aria-label="ุฅูุบุงุก ุงูุฑุฏ"><i class="bi bi-x"></i></button>
    </div>
  </div>

  <div class="edit-bar hidden" id="editBar">
    <div class="reply-bar-inner">
      <div class="reply-meta">
        <div class="reply-title">ุชุนุฏูู ุฑุณุงูุฉ</div>
        <div class="reply-snippet" id="editSnippet"></div>
      </div>
      <button type="button" class="reply-close" id="editCancel" aria-label="ุฅูุบุงุก ุงูุชุนุฏูู"><i class="bi bi-x"></i></button>
    </div>
  </div>

  <input type="hidden" id="receiver-id" value="{% if active_user %}{{ active_user.id }}{% endif %}">
  <input type="hidden" id="group-id" value="{% if active_group %}{{ active_group.id }}{% endif %}">
  <input type="hidden" id="reply-to-id" value="">
  <input type="hidden" id="edit-message-id" value="">

  <button type="button" class="tool-btn" id="attach-btn" aria-label="ูุฑููุงุช" title="ูุฑููุงุช">
    <i class="bi bi-paperclip"></i>
  </button>
  <input type="file" id="file-input" accept="*/*" hidden>

  <button type="button" class="tool-btn" id="camera-btn" aria-label="ูุงููุฑุง" title="ูุงููุฑุง">
    <i class="bi bi-camera"></i>
  </button>
  <input type="file" id="camera-input" accept="image/*" capture="environment" hidden>

  <button type="button" class="tool-btn" id="mic-btn" aria-label="ุชุณุฌูู ุตูุช" title="ุชุณุฌูู ุตูุช">
    <i class="bi bi-mic"></i>
  </button>
  <input type="file" id="audio-input" accept="audio/*" capture="microphone" hidden>

  <button type="button" class="emoji-btn" id="emoji-toggle" aria-label="Emoji" title="ุฅูููุฌู">
    <i class="bi bi-emoji-smile"></i>
  </button>
  <div class="emoji-picker" id="emoji-picker" aria-label="Emoji Picker"></div>

  <input type="text" name="content" id="message-content" placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง..." required autocomplete="off">

  <button type="submit" aria-label="send" title="ุฅุฑุณุงู">
    <i class="bi bi-send-fill"></i>
  </button>
</form>
    </div>
  </div>


  
  <!-- Create Group Modal -->
  <div class="modal-overlay hidden" id="createGroupModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="createGroupTitle">
      <h3 id="createGroupTitle">ุฅูุดุงุก ูุฌููุนุฉ</h3>
      <p>ุงูุชุจ ุงุณู ุงููุฌููุนุฉ ูุงุฎุชุฑ ุงูุฃุนุถุงุก (ุงูุงุณู ุฅูุฒุงูู).</p>

      <div class="form-row">
        <input type="text" id="groupNameInput" placeholder="ุงุณู ุงููุฌููุนุฉ" maxlength="60" required>
      </div>

      <div class="members-box" id="groupMembersBox" data-loaded="0">
        <div class="members-loading">ุฌุงุฑู ุชุญููู ุงูุฃุนุถุงุก...</div>
      </div>

      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="createGroupCancel">ุฅูุบุงุก</button>
        <button type="button" class="modal-btn primary" id="createGroupConfirm">ุฅูุดุงุก</button>
      </div>
    </div>
  </div>

  <!-- Group Invites Modal -->
  <div class="modal-overlay hidden" id="groupInvitesModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="invitesTitle">
      <h3 id="invitesTitle">ุทูุจุงุช ุงูุงูุถูุงู ูููุฌููุนุงุช</h3>
      <div id="invitesList" class="invites-list"></div>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="invitesClose">ุฅุบูุงู</button>
      </div>
    </div>
  </div>

<!-- Logout Modal -->
  <div class="modal-overlay hidden" id="logoutModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="logoutTitle">
      <h3 id="logoutTitle">ุชุณุฌูู ุงูุฎุฑูุฌ</h3>
      <p>ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ ุงูุขูุ</p>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="logoutCancel">ุฅูุบุงุก</button>
        <button type="button" class="modal-btn danger" id="logoutConfirm">ุชุณุฌูู ุฎุฑูุฌ</button>
      </div>
    </div>
  </div>

  <!-- Delete Group Modal -->
  <div class="modal-overlay hidden" id="deleteGroupModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="deleteGroupTitle">
      <h3 id="deleteGroupTitle">ุญุฐู ุงููุฌููุนุฉ</h3>
      <p>ูู ุชุฑูุฏ ุญุฐู ุงููุฌููุนุฉ ููุงุฆูุงูุ ูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู.</p>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="deleteGroupCancel">ุฅูุบุงุก</button>
        <button type="button" class="modal-btn danger" id="deleteGroupConfirm">ุญุฐู</button>
      </div>
    </div>
  </div>

  <!-- Leave Group Modal -->
  <div class="modal-overlay hidden" id="leaveGroupModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="leaveGroupTitle">
      <h3 id="leaveGroupTitle">ุงูุฎุฑูุฌ ูู ุงููุฌููุนุฉ</h3>
      <p>ูู ุชุฑูุฏ ุงูุฎุฑูุฌ ูู ุงููุฌููุนุฉุ</p>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="leaveGroupCancel">ุฅูุบุงุก</button>
        <button type="button" class="modal-btn danger" id="leaveGroupConfirm">ุฎุฑูุฌ</button>
      </div>
    </div>
  </div>

  <!-- Message Actions Menu (context / long-press) -->
  <div class="msg-menu hidden" id="msgMenu" role="menu" aria-label="ุฎูุงุฑุงุช ุงูุฑุณุงูุฉ">
    <button type="button" class="msg-menu-item" id="msgActReply"><i class="bi bi-reply"></i><span>ุฑุฏ</span></button>
    <button type="button" class="msg-menu-item" id="msgActForward"><i class="bi bi-forward"></i><span>ุฅุนุงุฏุฉ ุชูุฌูู</span></button>
    <button type="button" class="msg-menu-item" id="msgActCopy"><i class="bi bi-clipboard"></i><span>ูุณุฎ</span></button>
    <button type="button" class="msg-menu-item" id="msgActStar"><i class="bi bi-star"></i><span>ุชูููุฒ</span></button>
    <button type="button" class="msg-menu-item" id="msgActEdit"><i class="bi bi-pencil"></i><span>ุชุนุฏูู</span></button>
    <button type="button" class="msg-menu-item danger" id="msgActDeleteMe"><i class="bi bi-trash"></i><span>ุญุฐู ุนูุฏู</span></button>
    <button type="button" class="msg-menu-item danger" id="msgActDeleteAll"><i class="bi bi-trash3"></i><span>ุญุฐู ููุฌููุน</span></button>
  </div>

  <!-- Forward Modal -->
  <div class="modal-overlay hidden" id="forwardModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="forwardTitle">
      <h3 id="forwardTitle">ุฅุนุงุฏุฉ ุชูุฌูู</h3>
      <p>ุงุฎุชุฑ ูุญุงุฏุซุฉ ูุฅุฑุณุงู ุงูุฑุณุงูุฉ ุฅูููุง.</p>
      <div class="members-box" id="forwardTargets"></div>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="forwardCancel">ุฅูุบุงุก</button>
        <button type="button" class="modal-btn primary" id="forwardConfirm" disabled>ุฅุฑุณุงู</button>
      </div>
    </div>
  </div>

  <!-- Starred Messages Modal -->
  <div class="modal-overlay hidden" id="starredModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="starredTitle">
      <h3 id="starredTitle">ุงูุฑุณุงุฆู ุงููููุฒุฉ</h3>
      <div class="members-box" id="starredList"></div>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="starredClose">ุฅุบูุงู</button>
      </div>
    </div>
  </div>

  <!-- Group Info Modal -->
  <div class="modal-overlay hidden" id="groupInfoModal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="groupInfoTitle">
      <h3 id="groupInfoTitle">ูุนูููุงุช ุงููุฌููุนุฉ</h3>
      <div class="form-row" style="display:flex;gap:10px;align-items:center;">
        <button type="button" class="modal-btn primary" id="btnCreateInviteLink" style="flex:1;">ุฅูุดุงุก ุฑุงุจุท ุฏุนูุฉ</button>
        <button type="button" class="modal-btn secondary" id="btnCopyInviteLink" style="flex:1;" disabled>ูุณุฎ ุงูุฑุงุจุท</button>
      </div>
      <div class="form-row" style="margin-top:10px;">
        <input type="text" id="inviteLinkInput" readonly placeholder="ุณูุธูุฑ ุฑุงุจุท ุงูุฏุนูุฉ ููุง">
      </div>
      <div class="members-box" id="groupMembersList" data-loaded="0">
        <div class="members-loading">ุฌุงุฑู ุชุญููู ุงูุฃุนุถุงุก...</div>
      </div>
      <div class="modal-actions">
        <button type="button" class="modal-btn secondary" id="groupInfoClose">ุฅุบูุงู</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" crossorigin="anonymous"></script>
  <script defer src="{{ url_for('static', filename='js/chat.js') }}?v=18"></script>
<audio id="notifySound" preload="auto">
  <source src="{{ url_for('static', filename='sounds/notify.wav') }}" type="audio/wav">
</audio>


<!-- Edit Group Modal -->
<div class="modal-overlay hidden" id="editGroupModal">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="editGroupTitle">
    <h3 id="editGroupTitle">ุชุนุฏูู ุงุณู ุงููุฌููุนุฉ</h3>
    <p>ุงูุชุจ ุงูุงุณู ุงูุฌุฏูุฏ ูููุฌููุนุฉ.</p>

    <div class="form-row">
      <input type="text" id="editGroupName" placeholder="ุงุณู ุงููุฌููุนุฉ" maxlength="80" required>
    </div>

    <div class="modal-actions">
      <button type="button" class="modal-btn secondary" id="editGroupCancel">ุฅูุบุงุก</button>
      <button type="button" class="modal-btn primary" id="btnSaveGroupName">ุญูุธ</button>
    </div>
  </div>
</div>


<!-- Search Modal -->
<div class="modal fade" id="modalSearch" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ุจุญุซ ูู ุงูุฑุณุงุฆู</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control" id="searchQuery" placeholder="ุงูุชุจ ูููุฉ ููุจุญุซ..." autocomplete="off">
        <div class="mt-3" id="searchResults" style="display:flex;flex-direction:column;gap:10px;"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ุฅุบูุงู</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
